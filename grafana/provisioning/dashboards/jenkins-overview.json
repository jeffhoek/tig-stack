{
  "annotations": {
    "list": []
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "title": "Executor Usage",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 0 },
      "datasource": { "type": "influxdb", "uid": "" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "fillOpacity": 20,
            "lineWidth": 2,
            "spanNulls": false
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "busy_executors" },
            "properties": [
              { "id": "displayName", "value": "Busy Executors" },
              { "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "total_executors" },
            "properties": [
              { "id": "displayName", "value": "Total Executors" },
              { "id": "color", "value": { "fixedColor": "green", "mode": "fixed" } }
            ]
          }
        ]
      },
      "targets": [
        {
          "query": "from(bucket: \"jenkins\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"jenkins_node\")\n  |> filter(fn: (r) => r._field == \"busy_executors\" or r._field == \"total_executors\")\n  |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\n  |> yield(name: \"mean\")",
          "refId": "A"
        }
      ]
    },
    {
      "title": "Job Build Duration",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 0 },
      "datasource": { "type": "influxdb", "uid": "" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "fillOpacity": 10,
            "lineWidth": 2,
            "spanNulls": false
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "targets": [
        {
          "query": "from(bucket: \"jenkins\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"jenkins_job\")\n  |> filter(fn: (r) => r._field == \"duration\")\n  |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\n  |> yield(name: \"mean\")",
          "refId": "A"
        }
      ]
    },
    {
      "title": "Job Build Result",
      "type": "stat",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 8 },
      "datasource": { "type": "influxdb", "uid": "" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "red", "value": 1 }
            ]
          },
          "mappings": [
            { "options": { "0": { "text": "SUCCESS", "color": "green" } }, "type": "value" },
            { "options": { "1": { "text": "FAILURE", "color": "red" } }, "type": "value" },
            { "options": { "2": { "text": "UNSTABLE", "color": "yellow" } }, "type": "value" }
          ]
        },
        "overrides": []
      },
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "textMode": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        }
      },
      "targets": [
        {
          "query": "from(bucket: \"jenkins\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"jenkins_job\")\n  |> filter(fn: (r) => r._field == \"result_code\")\n  |> last()\n  |> yield(name: \"last\")",
          "refId": "A"
        }
      ]
    },
    {
      "title": "Build Number Over Time",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 8 },
      "datasource": { "type": "influxdb", "uid": "" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "fillOpacity": 0,
            "lineWidth": 2,
            "spanNulls": false,
            "drawStyle": "points",
            "pointSize": 8
          },
          "unit": "short"
        },
        "overrides": []
      },
      "targets": [
        {
          "query": "from(bucket: \"jenkins\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"jenkins_job\")\n  |> filter(fn: (r) => r._field == \"number\")\n  |> aggregateWindow(every: v.windowPeriod, fn: last, createEmpty: false)\n  |> yield(name: \"last\")",
          "refId": "A"
        }
      ]
    },
    {
      "title": "Node Status",
      "type": "table",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 16 },
      "datasource": { "type": "influxdb", "uid": "" },
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "online" },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-text"
                }
              },
              {
                "id": "mappings",
                "value": [
                  { "options": { "true": { "text": "Online", "color": "green" } }, "type": "value" },
                  { "options": { "false": { "text": "Offline", "color": "red" } }, "type": "value" }
                ]
              }
            ]
          }
        ]
      },
      "options": {
        "showHeader": true,
        "sortBy": []
      },
      "targets": [
        {
          "query": "from(bucket: \"jenkins\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"jenkins_node\")\n  |> filter(fn: (r) => r._field == \"online\" or r._field == \"num_executors\")\n  |> last()\n  |> pivot(rowKey: [\"_time\"], columnKey: [\"_field\"], valueColumn: \"_value\")\n  |> keep(columns: [\"node_name\", \"online\", \"num_executors\"])\n  |> yield(name: \"last\")",
          "refId": "A"
        }
      ]
    },
    {
      "title": "Node Response Time",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 16 },
      "datasource": { "type": "influxdb", "uid": "" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "fillOpacity": 10,
            "lineWidth": 2,
            "spanNulls": false
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "targets": [
        {
          "query": "from(bucket: \"jenkins\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"jenkins_node\")\n  |> filter(fn: (r) => r._field == \"response_time\")\n  |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\n  |> yield(name: \"mean\")",
          "refId": "A"
        }
      ]
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "tags": ["jenkins", "telegraf", "influxdb"],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-1h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "Jenkins Overview",
  "uid": "jenkins-overview",
  "version": 1
}
